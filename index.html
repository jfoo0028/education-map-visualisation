<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Pre-Primary Education Enrollment: Trends and Disparities</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #fff5f0;
            color: #333;
        }
        .container {
            width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            color: #a63603;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        h2 {
            color: #e6550d;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        .quote {
            font-style: italic;
            text-align: center;
            color: #a63603;
            margin-bottom: 30px;
        }
        .vis-container {
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(166, 54, 3, 0.1);
            padding: 20px;
            margin-bottom: 40px;
        }
        .chart-container {
            width: 100%;
        }
        .description-container {
            width: 100%;
            padding-top: 20px;
        }
        #map-vis {
            width: 100%;
            height: 0;
            padding-bottom: 56.25%;
            position: relative;
        }
        #map-vis > div {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }
        #bar-vis, #continent-pie-vis, #gender-enrollment-vis, #income-group-bubble-vis {
            width: 100%;
            height: 400px;
        }
        .search-container {
            margin-bottom: 20px;
        }
        #country-search {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .footer {
            text-align: center;
            padding: 20px;
            font-size: 0.9em;
            color: #666;
            background-color: #f5f5f5;
            border-top: 1px solid #ddd;
        }
        .footer a {
            color: #a63603;
            text-decoration: none;
        }
        .footer a:hover {
            text-decoration: underline;
        }
        .pie-chart-section {
            margin-bottom: 40px;
        }
        
        .pie-chart-container {
            display: flex;
            align-items: flex-start;
            gap: 20px;
        }
        
        #continent-pie-vis {
            flex: 0 0 400px;
            height: 400px;
        }
        
        .pie-description {
            flex: 1;
        }
        
        @media (max-width: 768px) {
            .pie-chart-container {
                flex-direction: column;
            }
        
            #continent-pie-vis {
                width: 100%;
            }
        }

        .hook {
            font-size: 1.2em;
            line-height: 1.5;
            color: #e6550d;
            text-align: center;
            margin-bottom: 30px;
            padding: 0 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Global Pre-Primary Education Enrollment: Trends and Disparities</h1>
        <p class="hook">
            Imagine a world where every child, regardless of gender or geography, has an equal start in education. Our global pre-primary enrollment data reveals how close—or far—we are from that reality. From gender parity trends to stark regional differences, this visualization uncovers the story of early childhood education across the globe. Are we making progress, or are some children being left behind? Let's explore the numbers that shape our youngest learners' futures.
        </p>
        <p class="quote">"Education is the most powerful weapon which you can use to change the world." — Nelson Mandela</p>
        
        <div class="vis-container">
            <h2>Pre-primary Education Enrollment Visualizations</h2>
            
            <div class="chart-section">
                <h3>Countries by Pre-primary Education Enrollment</h3>
                <div id="bar-vis" class="chart"></div>
                <p class="description">This chart showcases the top 20 or bottom 20 countries according to their pre-primary education enrollment numbers. Based on the top 20 bar chart, <b>India</b> and <b>China</b> are among the countries with the highest number of enrollments, whereas for the Bottom 20 bar chart, <b>Tokelau</b> and <b>Niue</b> are among the countries with the lowest number of enrollments.</p>
            </div>
    
            <div class="chart-section">
                <h3>Pre-primary Education Enrollment Map</h3>
                <div id="map-vis" class="chart"></div>
                <p class="description"><br>This world map visualizes <b>Enrollment Rate per 1000 people</b> across different countries as of 2023. The color intensity represents the enrollment rates, with darker orange shades indicating higher enrollment per capita. Countries are colored on a logarithmic scale ranging from less than 1 to over 100 enrollments per 1000 population.</p>
                <p class="description">Using the "Select Country" filter, we can see that Malaysia has an enrollment rate of <b>27.8 per 1000 people</b>, which is higher than the average for countries worldwide. This suggests that Malaysia places a strong emphasis on early childhood education compared to many other nations.</p>
            </div>
    
            <div class="chart-section pie-chart-section">
                <h3>Pre-primary Education Enrollment by Continent</h3>
                <div class="pie-chart-container">
                    <div id="continent-pie-vis" class="chart"></div>
                    <div class="pie-description">
                        <p>This chart illustrates the distribution of pre-primary education enrollment across continents in 2023. <b>Asia</b> dominates the chart with a significantly larger share, roughly <strong>115.819K</strong> enrollments. Asia's lead in pre-primary education enrollment is driven by its large population, a cultural emphasis on early education, and increased investment in educational infrastructure.</p>
                    </div>
                </div>
            </div>
    
            <br>
            <div class="chart-section">
                <h3>Pre-primary Education Enrollment by Gender (World)</h3>
                <div id="gender-enrollment-vis" class="chart"></div>
                <p class="description">This chart compares pre-primary education enrollment between males and females globally from 2017 to 2023. The visualization reveals a remarkable trend towards <b>gender parity in early childhood education.</b> Over this period, the enrollment numbers for both genders remain consistently close, with only slight variations. This near-equal representation suggests significant progress in providing equitable access to pre-primary education worldwide, regardless of gender. Users can adjust the year range using the slider, allowing for a more detailed examination of enrollment trends and any subtle shifts in gender balance over time. The chart not only highlights the current state of gender equality in early education but also reflects global efforts to ensure inclusive and accessible pre-primary schooling for all children.</p>
            </div>
    
            <div class="chart-section">
                <h3>Pre-primary Education Enrollment by Income Country Group</h3>
                <div id="income-group-line-vis" class="chart"></div>
                <p class="description">This line chart illustrates the trends in pre-primary education enrollment across different income groups from 2017 to 2023. Each line represents a different income group category: low income, lower middle income, upper middle income, and high income countries.</p>
                <p>It can be seen that the <b>upper and lower middle income countries</b> focus on education more compared the low and high income countries.Upper and lower middle income countries are often in a phase of rapid economic growth and development. During this stage, there's typically:</p>
                <ul>
                    <li>Increased investment in human capital, including education, to support economic advancement.</li>
                    <li>A growing middle class with higher aspirations for their children's education and future prospects.</li>
                </ul>
            </div>
        </div>

        <div class="footer">
            <p>Foo Jia Wei, Bryan. 10/10/2024. Data from <a href="https://data.uis.unesco.org/index.aspx?queryid=3813">Unesco</a>. Source code on <a href="https://github.com/jfoo0028/education-map-visualisation">GitHub</a>.</p>
        </div>
    </div>

    <script>
        const mapSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "title": "Pre-primary Education Enrollment Map (2023)",
            "width": "container",
            "height": "container",
            "autosize": {
              "type": "fit",
              "contains": "padding"
            },
            "projection": { "type": "equalEarth" },
            "params": [
              {
                "name": "country_search",
                "bind": {
                  "input": "text",
                  "placeholder": "Search for a country",
                  "name": "Select Country: "
                },
                "value": ""
              }
            ],
            "layer": [
              {
                "data": {
                  "url": "https://raw.githubusercontent.com/FIT3179/Vega-Lite/main/7_others/oceans.topojson",
                  "format": { "type": "topojson", "feature": "oceans" }
                },
                "mark": { "type": "geoshape", "fill": "skyblue" }
              },
              {
                "data": { "graticule": true },
                "mark": { "type": "geoshape", "stroke": "#ccc" }
              },
              {
                "data": {
                  "url": "https://raw.githubusercontent.com/jfoo0028/education-map-visualisation/refs/heads/main/ne_110m_admin_0_countries.topojson",
                  "format": { "type": "topojson", "feature": "ne_110m_admin_0_countries" }
                },
                "transform": [
                  {
                    "lookup": "properties.NAME",
                    "from": {
                      "data": {
                        "url": "https://raw.githubusercontent.com/jfoo0028/education-map-visualisation/refs/heads/main/enrollment_per_1000_population.csv"
                      },
                      "key": "Country",
                      "fields": ["Enrollment_per_1000"]
                    }
                  },
                  {
                    "calculate": "datum.Enrollment_per_1000 > 0 ? datum.Enrollment_per_1000 : null",
                    "as": "enrollment"
                  },
                  {
                    "filter": "!country_search || test(regexp(country_search, 'i'), datum.properties.NAME)"  // Use "country_search" as filter name
                  }
                ],
                "mark": { "type": "geoshape" },
                "encoding": {
                  "color": {
                    "field": "enrollment",
                    "type": "quantitative",
                    "scale": { "type": "log", "scheme": "oranges" },
                    "legend": { "title": "Enrollment per 1000 population (log scale)" }
                  },
                  "tooltip": [
                    { "field": "properties.NAME", "type": "nominal", "title": "Country" },
                    { "field": "enrollment", "type": "quantitative", "title": "Enrollment per 1000 population", "format": ".1f" }
                  ]
                }
              }
            ]
        };
          
    const barSpec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "title": "Countries by Pre-primary Education Enrollment (2023)",
        "data": {
          "url": "https://raw.githubusercontent.com/jfoo0028/education-map-visualisation/main/preprimary_enrollment_countries_only.csv"
        },
        "params": [
          {
            "name": "rankType",
            "value": "top",
            "bind": {
              "input": "radio",
              "options": ["top", "bottom"],
              "labels": ["Top 20", "Bottom 20"],
              "name": "Select Ranking: "
            }
          }
        ],
        "transform": [
          {"calculate": "isValid(datum.enrollment) ? toNumber(datum.enrollment) : 0", "as": "enrollmentNumber"},
          {"filter": "datum.enrollmentNumber > 0"},
          {
            "window": [
              {"op": "rank", "as": "rank"},
              {"op": "count", "as": "totalCount"}
            ],
            "sort": [{"field": "enrollmentNumber", "order": "descending"}]
          },
          {
            "filter": "rankType === 'top' ? datum.rank <= 20 : datum.rank >= datum.totalCount - 19"
          },
          {
            "filter": "rankType === 'bottom' ? datum.rank >= 173 : datum.rank >= datum.totalCount - 19"
          }
        ],
        "width": "container",
        "height": 400,
        "mark": "bar",
        "encoding": {
          "y": {
            "field": "Country",
            "type": "nominal",
            "sort": {"field": "enrollmentNumber", "order": {"expr": "rankType === 'top' ? 'descending' : 'ascending'"}},
            "axis": {"title": null}
          },
          "x": {
            "field": "enrollmentNumber",
            "type": "quantitative",
            "axis": {"title": "Enrollment", "format": ",.0f"}
          },
          "color": {
            "field": "enrollmentNumber",
            "type": "quantitative",
            "scale": {"scheme": "oranges"},
            "legend": null
          },
          "tooltip": [
            {"field": "Country", "type": "nominal"},
            {"field": "enrollmentNumber", "type": "quantitative", "format": ",.0f", "title": "Enrollment"}
          ]
        }
      };
      

    const continentPieSpec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "title": "Pre-primary Education Enrollment by Continent (2023)",
        "data": {
            "url": "https://raw.githubusercontent.com/jfoo0028/education-map-visualisation/refs/heads/main/cleaned_continent_data.csv"
        },
        "transform": [
            {"filter": "datum.Continent != null"},
            {
                "filter": {
                    "or": [
                        {"param": "continent_selection", "empty": true},
                        {"param": "continent_selection", "field": "Continent"}
                    ]
                }
            }
        ],
        "width": 400,
        "height": 400,
        "mark": {"type": "arc", "innerRadius": 50},
        "encoding": {
            "theta": {
                "field": "enrollment",
                "type": "quantitative",
                "stack": true
            },
            "color": {
                "field": "Continent",
                "type": "nominal",
                "scale": {"scheme": "category10"}
            },
            "tooltip": [
                {"field": "Continent", "type": "nominal", "title": "Continent"},
                {"field": "enrollment", "type": "quantitative", "title": "Enrollment", "format": ","}
            ]
        },
        "view": {"stroke": null},
        "params": [
            {
                "name": "continent_selection",
                "select": {
                    "type": "point",
                    "fields": ["Continent"]
                },
                "bind": {
                    "input": "select",
                    "options": [null, "Africa", "Asia", "Europe", "North America", "Oceania", "South America"],
                    "labels": ["All", "Africa", "Asia", "Europe", "North America", "Oceania", "South America"],
                    "name": "Select Continent: "
                }
            }
        ]
    };

    const genderBarSpec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "title": "Pre-primary Education Enrollment by Gender (World)",
        "width": 600,
        "height": 400,
        "data": {
          "url": "https://raw.githubusercontent.com/jfoo0028/education-map-visualisation/refs/heads/main/cleaned_gender_enrolment.csv"
        },
        "params": [
          {
            "name": "min_year",
            "value": 2017,
            "bind": {
              "input": "range",
              "min": 2017,
              "max": 2023,
              "step": 1,
              "name": "Year Range (Max: 2023)"
            }
          }
        ],
        "transform": [
          {"filter": "datum.Time >= min_year && datum.Time <= 2023"}
        ],
        "mark": "bar",
        "encoding": {
          "x": {
            "field": "Time",
            "type": "ordinal",
            "title": "Year",
            "axis": {
              "labelAngle": 0
            }
          },
          "y": {
            "field": "Value",
            "type": "quantitative",
            "title": "Enrollment",
            "axis": {"format": ",.0f"}
          },
          "color": {
            "field": "Gender",
            "type": "nominal",
            "scale": {
              "domain": ["female", "male"],
              "range": ["#FF69B4", "#4169E1"]
            },
            "title": "Gender"
          },
          "xOffset": {"field": "Gender"},
          "tooltip": [
            {"field": "Time", "type": "ordinal", "title": "Year"},
            {"field": "Gender", "type": "nominal", "title": "Gender"},
            {"field": "Value", "type": "quantitative", "title": "Enrollment", "format": ",.0f"}
          ]
        },
        "config": {
          "view": {"stroke": null},
          "axis": {"grid": false}
        }
      }

    const incomeGroupLineSpec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "title": "Pre-primary Education Enrollment by Income Country Group (2017-2023)",
        "width": 600,
        "height": 400,
        "data": {
          "url": "https://raw.githubusercontent.com/jfoo0028/education-map-visualisation/refs/heads/main/enrollment_income_groups.csv"
        },
        "mark": {
          "type": "line",
          "point": true
        },
        "encoding": {
          "x": {
            "field": "Time",
            "type": "ordinal",
            "title": "Year"
          },
          "y": {
            "field": "Value",
            "type": "quantitative",
            "title": "Enrollment",
            "axis": {"format": "~s"}
          },
          "color": {
            "field": "Country",
            "type": "nominal",
            "title": "Income Country Group",
            "scale": {
              "domain": ["Low income countries", "Lower middle income countries", "Upper middle income countries", "High income countries"],
              "range": ["#e41a1c", "#377eb8", "#984ea3", "#ff7f00"]
            }
          },
          "tooltip": [
            {"field": "Country", "type": "nominal", "title": "Income Group"},
            {"field": "Time", "type": "ordinal", "title": "Year"},
            {"field": "Value", "type": "quantitative", "title": "Enrollment", "format": ","}
          ]
        },
        "config": {
          "view": {"stroke": null}
        }
      };


    vegaEmbed('#map-vis', mapSpec).then((result) => {
        const view = result.view;
        document.getElementById('country-search').addEventListener('input', function(event) {
            view.signal('country_search', event.target.value).run();
        });
    });
    vegaEmbed('#bar-vis', barSpec);
    vegaEmbed('#continent-pie-vis', continentPieSpec);
    vegaEmbed('#gender-enrollment-vis', genderBarSpec);
    vegaEmbed('#income-group-line-vis', incomeGroupLineSpec);
    </script>
</body>
</html>
