<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Education Level Visualizations</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <style>
        /* Your existing styles here */
    </style>
</head>
<body>
    <div class="container">
        <h1>Education Enrollment Visualizations</h1>
    
        <div class="vis-container">
            <div class="chart-container">
                <h2>Pre-primary Education Enrollment Rate Map</h2>
                <div id="map-vis"></div>
            </div>
            <div class="description-container">
                <h2>Description</h2>
                <p>This map visualizes pre-primary education enrollment rates across different countries. The color intensity represents the enrollment rate per 1,000 population, with darker shades indicating higher rates. This normalized perspective helps identify regional trends and disparities in early childhood education access while accounting for population differences.</p>
            </div>
        </div>
    
        <div class="vis-container">
            <div class="chart-container">
                <h2>Top 20 Countries by Enrollment Rate</h2>
                <div id="bar-vis"></div>
            </div>
            <div class="description-container">
                <h2>Description</h2>
                <p>This bar chart showcases the top 20 countries with the highest pre-primary education enrollment rates per 1,000 population. It provides a clear comparison of enrollment rates among leading nations, highlighting which countries are at the forefront of early childhood education initiatives relative to their population size.</p>
            </div>
        </div>

        <div class="vis-container">
            <div class="chart-container">
                <h2>Pre-primary Education Enrollment Rate by Continent</h2>
                <div id="continent-bar-vis"></div>
            </div>
            <div class="description-container">
                <h2>Description</h2>
                <p>This chart breaks down pre-primary education enrollment rates by continent. It offers insights into how different regions prioritize early childhood education relative to their population sizes, allowing for continental comparisons and potentially revealing socio-economic factors influencing enrollment rates.</p>
            </div>
        </div>
    </div>

    <script>
    const mapSpec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "title": "Pre-primary Education Enrollment Rate per 1,000 Population (2023)",
        "width": "container",
        "height": "container",
        "autosize": {
            "type": "fit",
            "contains": "padding"
        },
        "projection": {"type": "equalEarth"},
        "layer": [
            {
              "data": {
                "url": "https://raw.githubusercontent.com/FIT3179/Vega-Lite/main/7_others/oceans.topojson",
                "format": { "type": "topojson", "feature": "oceans" }
              },
              "mark": { "type": "geoshape", "fill": "skyblue" }
            },
            {
                "data": {"graticule": true},
                "mark": {"type": "geoshape", "stroke": "#ccc"}
            },
            {
                "data": {
                    "url": "https://raw.githubusercontent.com/jfoo0028/education-map-visualisation/refs/heads/main/ne_110m_admin_0_countries.topojson",
                    "format": {"type": "topojson", "feature": "ne_110m_admin_0_countries"}
                },
                "transform": [
                    {
                        "lookup": "properties.NAME",
                        "from": {
                            "data": {
                                "url": "https://raw.githubusercontent.com/jfoo0028/education-map-visualisation/refs/heads/main/enrollment_per_1000_population.csv"
                            },
                            "key": "Country",
                            "fields": ["Enrollment_per_1000"]
                        }
                    }
                ],
                "mark": {"type": "geoshape"},
                "encoding": {
                    "color": {
                        "field": "Enrollment_per_1000",
                        "type": "quantitative",
                        "scale": {"type": "log", "scheme": "oranges"},
                        "legend": {"title": "Enrollment Rate per 1,000 Population (log scale)"}
                    },
                    "tooltip": [
                        {"field": "properties.NAME", "type": "nominal", "title": "Country"},
                        {"field": "Enrollment_per_1000", "type": "quantitative", "title": "Enrollment Rate per 1,000", "format": ".2f"}
                    ]
                }
            }
        ]
    };

    const barSpec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "title": "Top 20 Countries by Pre-primary Education Enrollment Rate (2023)",
        "data": {
            "url": "https://raw.githubusercontent.com/jfoo0028/education-map-visualisation/refs/heads/main/enrollment_per_1000_population.csv"
        },
        "transform": [
            {"filter": "datum.Enrollment_per_1000 > 0"},
            {"window": [{"op": "rank", "as": "rank"}], "sort": [{"field": "Enrollment_per_1000", "order": "descending"}]},
            {"filter": "datum.rank <= 20"}
        ],
        "width": "container",
        "height": 400,
        "mark": "bar",
        "encoding": {
            "y": {
                "field": "Country",
                "type": "nominal",
                "sort": "-x",
                "axis": {"title": null}
            },
            "x": {
                "field": "Enrollment_per_1000",
                "type": "quantitative",
                "axis": {"title": "Enrollment Rate per 1,000 Population", "format": ",.1f"}
            },
            "color": {
                "field": "Enrollment_per_1000",
                "type": "quantitative",
                "scale": {"scheme": "oranges"},
                "legend": null
            },
            "tooltip": [
                {"field": "Country", "type": "nominal"},
                {"field": "Enrollment_per_1000", "type": "quantitative", "format": ",.1f", "title": "Enrollment Rate per 1,000"}
            ]
        },
        "selection": {
            "highlight": {"type": "single", "empty": "none", "on": "mouseover"}
        },
        "opacity": {
            "condition": {"selection": "highlight", "value": 1},
            "value": 0.7
        }
    };

    const continentBarSpec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "title": "Pre-primary Education Enrollment Rate by Continent (2023)",
        "data": {
            "url": "https://raw.githubusercontent.com/jfoo0028/education-map-visualisation/refs/heads/main/enrollment_per_1000_population.csv"
        },
        "transform": [
            {
                "aggregate": [{
                    "op": "mean",
                    "field": "Enrollment_per_1000",
                    "as": "avg_enrollment_rate"
                }],
                "groupby": ["Continent"]
            },
            {"filter": "datum.Continent != null"},
            {
                "filter": {
                    "or": [
                        {"param": "continent_selection", "empty": true},
                        {"param": "continent_selection", "field": "Continent"}
                    ]
                }
            }
        ],
        "width": "container",
        "height": 400,
        "mark": "bar",
        "encoding": {
            "x": {
                "field": "Continent",
                "type": "nominal",
                "axis": {
                    "labelAngle": 30,
                    "labelPadding": 10,
                    "labelFontSize": 12
                }
            },
            "y": {
                "field": "avg_enrollment_rate",
                "type": "quantitative",
                "title": "Average Enrollment Rate per 1,000 Population"
            },
            "color": {
                "field": "avg_enrollment_rate",
                "type": "quantitative",
                "scale": {"scheme": "oranges"},
                "legend": null
            },
            "tooltip": [
                {"field": "Continent", "type": "nominal", "title": "Continent"},
                {"field": "avg_enrollment_rate", "type": "quantitative", "title": "Avg. Enrollment Rate per 1,000", "format": ",.1f"}
            ]
        },
        "params": [
            {
                "name": "continent_selection",
                "select": {
                    "type": "point",
                    "fields": ["Continent"]
                },
                "bind": {
                    "input": "select",
                    "options": [null, "Africa", "Asia", "Europe", "North America", "Oceania", "South America"],
                    "labels": ["All", "Africa", "Asia", "Europe", "North America", "Oceania", "South America"],
                    "name": "Select Continent: "
                }
            }
        ]
    };

    vegaEmbed('#map-vis', mapSpec);
    vegaEmbed('#bar-vis', barSpec);
    vegaEmbed('#continent-bar-vis', continentBarSpec);
    </script>
</body>
</html>
